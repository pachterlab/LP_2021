<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Data analysis in the prequel era | Museum of Spatial Transcriptomics</title>
<meta name="author" content="Lambda Moses">
<meta name="author" content="Lior Pachter">
<meta name="description" content="Many machine learning and statistics methods are mentioned in this chapter. The names of these methods are linked to articles explaining them for those who are unfamiliar. Some of them are math...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 3 Data analysis in the prequel era | Museum of Spatial Transcriptomics">
<meta property="og:type" content="book">
<meta property="og:description" content="Many machine learning and statistics methods are mentioned in this chapter. The names of these methods are linked to articles explaining them for those who are unfamiliar. Some of them are math...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Data analysis in the prequel era | Museum of Spatial Transcriptomics">
<meta name="twitter:description" content="Many machine learning and statistics methods are mentioned in this chapter. The names of these methods are linked to articles explaining them for those who are unfamiliar. Some of them are math...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Museum of Spatial Transcriptomics</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introduction</a></li>
<li class="book-part">Prequel era</li>
<li><a class="" href="prequel.html"><span class="header-section-number">2</span> Prequel era</a></li>
<li><a class="active" href="prequel-analysis.html"><span class="header-section-number">3</span> Data analysis in the prequel era</a></li>
<li class="book-part">Current era</li>
<li><a class="" href="current.html"><span class="header-section-number">4</span> From the past to the present</a></li>
<li><a class="" href="current-techs.html"><span class="header-section-number">5</span> Current era technologies</a></li>
<li><a class="" href="text-mining.html"><span class="header-section-number">6</span> Text mining LCM transcriptomics abstracts</a></li>
<li><a class="" href="current-analysis.html"><span class="header-section-number">7</span> Data analysis in the current era</a></li>
<li class="book-part">Future perspectives</li>
<li><a class="" href="future.html"><span class="header-section-number">8</span> From the past to the present to the future</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/pachterlab/LP_2021/tree/main/supplement">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="prequel-analysis" class="section level1">
<h1>
<span class="header-section-number">3</span> Data analysis in the prequel era<a class="anchor" aria-label="anchor" href="#prequel-analysis"><i class="fas fa-link"></i></a>
</h1>

<div class="rmdtip">
Many machine learning and statistics methods are mentioned in this chapter. The names of these methods are linked to articles explaining them for those who are unfamiliar. Some of them are math heavy.
</div>

<p>From the earliest days of enhancer and gene traps to the (WM)ISH atlases, identifying genes with spatially and temporally variable expression patterns, comparing and classifying the patterns, identifying new marker genes of cell types and developmental stages, and using gene expression to redefine cell types have been among the goals of the studies <span class="citation">(O’Kane and Gehring <a href="references.html#ref-OKane1987" role="doc-biblioref">1987</a>; Gossler et al. <a href="references.html#ref-Gossler1989" role="doc-biblioref">1989</a>; Wurst et al. <a href="references.html#ref-Wurst1995a" role="doc-biblioref">1995</a>; Sundaresan et al. <a href="references.html#ref-Sundaresan1995" role="doc-biblioref">1995</a>; Gawantka et al. <a href="references.html#ref-Gawantka1998" role="doc-biblioref">1998</a>; Tomancak et al. <a href="references.html#ref-Tomancak2002" role="doc-biblioref">2002</a>; Lein et al. <a href="references.html#ref-Lein2007" role="doc-biblioref">2007</a>)</span>. In the prequel era, these were typically done manually, which, with the growing size of atlases in the 2000s, was time consuming and potentially inconsistent between curators. Thus, computational methods were developed to analyze images from the (WM)ISH atlases. This chapter reviews data analysis methods designed for (WM)ISH atlases and does not involve scRNA-seq data; methods involving both (WM)ISH and scRNA-seq are reviewed in Chapter <a href="current-analysis.html#current-analysis">7</a> for the current era because scRNA-seq is at present a popular and rapidly growing field, too in vogue to be considered “prequel”. If our collection is representative, then the rise of prequel data analysis methods arrived much later than that of data collection (Figure <a href="prequel-analysis.html#fig:prequel-poly">3.1</a>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:prequel-poly"></span>
<img src="03-prequel_analysis_files/figure-html/prequel-poly-1.png" alt="Comparing trends in data collection and data analysis in the prequel era. Bin width is 365 days. The x-shaped points show the number of publications from the last bin, which is not yet full." width="672"><p class="caption">
Figure 3.1: Comparing trends in data collection and data analysis in the prequel era. Bin width is 365 days. The x-shaped points show the number of publications from the last bin, which is not yet full.
</p>
</div>
<p>Except for one study on <em>Platynereis dumereilii</em> in 2014 <span class="citation">(Pettit et al. <a href="references.html#ref-Pettit2014" role="doc-biblioref">2014</a>)</span>, on <em>Xenopus tropicalis</em> in 2018 <span class="citation">(Patrushev et al. <a href="references.html#ref-Patrushev2018" role="doc-biblioref">2018</a>)</span>, one on post mortem human brain in 2021 <span class="citation">(Abed-Esfahani et al. <a href="references.html#ref-Abed-Esfahani2021" role="doc-biblioref">2021</a>)</span>, all data analysis methods in our collection were designed for either <em>Drosophila melanogaster</em> or <em>Mus musculus</em> (Figure <a href="prequel-analysis.html#fig:pa-species">3.2</a>). There seem to have been two waves; the first for <em>Drosophila</em>, peaking in the late 2000s, mostly concerning the BDGP in situ atlas, and the second for mice, peaking in early 2010s, mostly concerning ABA (Figure <a href="prequel-analysis.html#fig:pa-species">3.2</a>). The apparent rise since 2019 is in part driven by deep learning methods to annotate gene expression patterns or infer gene interactions. Given the small number of publications in this category and potential incompleteness of the curation, the trends should be taken with a grain of salt.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pa-species"></span>
<img src="03-prequel_analysis_files/figure-html/pa-species-1.png" alt="Gray histogram in the background is overall histogram of prequel data analysis literature. Number of publications in each time bin for each species is highlighted in the facets." width="576"><p class="caption">
Figure 3.2: Gray histogram in the background is overall histogram of prequel data analysis literature. Number of publications in each time bin for each species is highlighted in the facets.
</p>
</div>
<div id="prequel-gene-patterns" class="section level2">
<h2>
<span class="header-section-number">3.1</span> Gene patterns<a class="anchor" aria-label="anchor" href="#prequel-gene-patterns"><i class="fas fa-link"></i></a>
</h2>
<p>The most common goal of these data analysis methods was to annotate and compare gene expression patterns, especially to automate annotation of the BDGP atlas (Figure <a href="prequel-analysis.html#fig:pa-category">3.3</a>). It seems reasonable to focus on 4 phases in this category: first, in early to mid 2000s, after image registration, the images were binarized into “expressed” and “not expressed” regions, and the shapes of the expressed regions were summarized and compared. Metrics to summarize the shapes included <a href="https://towardsdatascience.com/introduction-to-the-invariant-moment-and-its-application-to-the-feature-extraction-ee991f39ec">moment invariant</a> <span class="citation">(Jayaraman, Panchanathan, and Kumar <a href="references.html#ref-Jayaraman2001" role="doc-biblioref">2001</a>; Gurunathan et al. <a href="references.html#ref-Gurunathan2004" role="doc-biblioref">2004</a>)</span>, Hamming distance <span class="citation">(Kumar et al. <a href="references.html#ref-Kumar2002" role="doc-biblioref">2002</a>)</span>, and a weighted score involving <a href="https://iq.opengenus.org/manhattan-distance/">L1 distance</a> between column or row histograms of two images <span class="citation">(Liu et al. <a href="references.html#ref-Liu2007" role="doc-biblioref">2007</a>)</span>. These unsupervised methods enabled clustering of patterns and querying genes with similar patterns to a given gene.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pa-category"></span>
<img src="03-prequel_analysis_files/figure-html/pa-category-1.png" alt="Number of publications in each time bin for each category of data analysis is highlighted in the facets." width="576"><p class="caption">
Figure 3.3: Number of publications in each time bin for each category of data analysis is highlighted in the facets.
</p>
</div>
<p>Second, from the mid 2000s to mid 2010s, many supervised and unsupervised methods for gene expression pattern annotation or comparison were developed. In supervised methods, extensive feature engineering more sophisticated than binarization was performed on registered images for image annotation with machine learning classification. These methods were trained with existing BDGP annotations and developed to automatically annotate the BDGP expression patterns with controlled vocabulary (CV) of anatomical regions where genes were expressed. In BDGP, a gene gets annotated with a CV if the gene was deemed expressed in the anatomical region and developmental stage denoted by the CV, so the annotation typically contained a list of CVs.</p>
<p>The feature engineering can be based on the wavelet transform <span class="citation">(Zhou and Peng <a href="references.html#ref-Zhou2007a" role="doc-biblioref">2007</a>)</span> and Fourier coefficients <span class="citation">(Heffel et al. <a href="references.html#ref-Heffel2008a" role="doc-biblioref">2008</a>)</span>, but a particularly popular feature engineering method was <a href="https://docs.opencv.org/master/da/df5/tutorial_py_sift_intro.html">scale-invariant feature transform (SIFT)</a> <span class="citation">(Lowe <a href="references.html#ref-Lowe2004" role="doc-biblioref">2004</a>; Ji et al. <a href="references.html#ref-Ji2008" role="doc-biblioref">2008</a>; Li et al. <a href="references.html#ref-Li2009" role="doc-biblioref">2009</a>; S. Ji, Li, et al. <a href="references.html#ref-Ji2009" role="doc-biblioref">2009</a>)</span>. A method published in 2009 that used SIFT followed by <a href="https://machinelearningmastery.com/gentle-introduction-bag-words-model/">bag of words</a> where “word” is a <a href="https://medium.com/analytics-vidhya/k-means-clustering-explained-419ee66d095e">k means</a> cluster (code book) was quite influential <span class="citation">(S. Ji, Li, et al. <a href="references.html#ref-Ji2009" role="doc-biblioref">2009</a>)</span>; several later methods were inspired by this method, with improved code books <span class="citation">(Sun et al. <a href="references.html#ref-Sun2013" role="doc-biblioref">2013</a>; S. Ji, Yuan, et al. <a href="references.html#ref-Ji2009a" role="doc-biblioref">2009</a>; Yuan et al. <a href="references.html#ref-Yuan2012" role="doc-biblioref">2012</a>; Liscovitch, Shalit, and Chechik <a href="references.html#ref-Liscovitch2013a" role="doc-biblioref">2013</a>)</span>. The most common classifier that take in the features to predict annotations is <a href="https://towardsdatascience.com/support-vector-machine-introduction-to-machine-learning-algorithms-934a444fca47">support vector machine (SVM)</a> <span class="citation">(Sun et al. <a href="references.html#ref-Sun2013" role="doc-biblioref">2013</a>; Yuan et al. <a href="references.html#ref-Yuan2012" role="doc-biblioref">2012</a>)</span> or multi-label variants of it <span class="citation">(Ji et al. <a href="references.html#ref-Ji2008" role="doc-biblioref">2008</a>; S. Ji, Li, et al. <a href="references.html#ref-Ji2009" role="doc-biblioref">2009</a>)</span>.</p>
<p>Unsupervised methods rely on clustering algorithms after images are registered on a common mesh, such as <a href="https://towardsdatascience.com/unsupervised-machine-learning-affinity-propagation-algorithm-explained-d1fef85f22c8">affinity propagation clustering</a> <span class="citation">(Frise, Hammonds, and Celniker <a href="references.html#ref-Frise2010" role="doc-biblioref">2010</a>)</span> and co-clustering (rows and columns of matrix are clustered simultaneously) <span class="citation">(Jagalur et al. <a href="references.html#ref-Jagalur2007" role="doc-biblioref">2007</a>; Zhang et al. <a href="references.html#ref-Zhang2013" role="doc-biblioref">2013</a>)</span>.</p>
<p>Third, another notable type of the feature engineering is dimension reduction. In 2006, some methods applied dimension reduction methods such as <a href="https://liorpachter.wordpress.com/2014/05/26/what-is-principal-component-analysis/">principal component analysis (PCA)</a> and <a href="http://wwwf.imperial.ac.uk/~nsjones/TalkSlides/HyvarinenSlides.pdf">independent component analysis (ICA)</a> to the registered images to find “eigen” patterns <span class="citation">(Pan et al. <a href="references.html#ref-Pan2006" role="doc-biblioref">2006</a>; Hanchuan Peng et al. <a href="references.html#ref-Peng2006" role="doc-biblioref">2006</a>)</span>. Instead of PCA or ICA, the dimension reduction can also be sparse Bayesian factor analysis <span class="citation">(Pruteanu-Malinici, Mace, and Ohler <a href="references.html#ref-Pruteanu-Malinici2011" role="doc-biblioref">2011</a>)</span>, sparse dictionary learning <span class="citation">(Li et al. <a href="references.html#ref-Li2017" role="doc-biblioref">2017</a>)</span>, and <a href="http://www.cs.cmu.edu/~11755/lectures/Lee_Seung_NMF.pdf">non-negative matrix factorization (NMF)</a> <span class="citation">(Noto, Barnagian, and Castro <a href="references.html#ref-Noto2017" role="doc-biblioref">2017</a>; Wu et al. <a href="references.html#ref-Wu2016" role="doc-biblioref">2016</a>)</span>. The dimension reduction can be used for unsupervised clustering of genes <span class="citation">(Pan et al. <a href="references.html#ref-Pan2006" role="doc-biblioref">2006</a>; Hanchuan Peng et al. <a href="references.html#ref-Peng2006" role="doc-biblioref">2006</a>; Pruteanu-Malinici, Mace, and Ohler <a href="references.html#ref-Pruteanu-Malinici2011" role="doc-biblioref">2011</a>)</span>, as well as supervised classification methods such as SVM and <a href="https://towardsdatascience.com/logistic-regression-detailed-overview-46c4da4303bc">logistic regression</a> to annotate gene expression patterns with controlled vocabulary <span class="citation">(Pruteanu-Malinici, Mace, and Ohler <a href="references.html#ref-Pruteanu-Malinici2011" role="doc-biblioref">2011</a>; Wu et al. <a href="references.html#ref-Wu2016" role="doc-biblioref">2016</a>)</span>. Notably, in NMF, both the matrix for basis patterns and the coefficient matrix for the genes tend to exhibit block structures; the blocks in the gene coefficient matrix has been used to cluster genes <span class="citation">(Noto, Barnagian, and Castro <a href="references.html#ref-Noto2017" role="doc-biblioref">2017</a>)</span>.</p>
<p>Fourth, since 2015, <a href="https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53">convolutional neural networks (CNNs)</a> have been adopted to analyze gene expression patterns. Typically, a pre-trained model, such as ResNet50, OverFeat, or Alexnet is used. With some modifications or retraining of the original model, the model can be used to extract features for gene pattern annotation with logistic regression <span class="citation">(Zeng et al. <a href="references.html#ref-Zeng2015" role="doc-biblioref">2015</a>)</span>, classifying new patterns <span class="citation">(Andonian et al. <a href="references.html#ref-Andonian2019" role="doc-biblioref">2019</a>, @Long2021)</span>, and predicting interactions between genes <span class="citation">(Yang, Fang, and Shen <a href="references.html#ref-Yang2019" role="doc-biblioref">2019</a>)</span>.</p>
</div>
<div id="prequel-spatial-regions" class="section level2">
<h2>
<span class="header-section-number">3.2</span> Spatial regions<a class="anchor" aria-label="anchor" href="#prequel-spatial-regions"><i class="fas fa-link"></i></a>
</h2>
<p>Closely related to classifying gene expression patterns are these questions: What are the implications of gene expression patterns to traditional anatomical regions as in the CV? Can we discover novel anatomical regions from gene expression? How well do expression-based regions correspond to the traditional regions? A few studies, which we call “spatial region”, tried to answer these questions in the ABA (Figure <a href="prequel-analysis.html#fig:pa-category">3.3</a>). Clusters of expression patterns of cell type specific genes <span class="citation">(Ko et al. <a href="references.html#ref-Ko2013" role="doc-biblioref">2013</a>)</span>, or the most localized genes <span class="citation">(Grange et al. <a href="references.html#ref-Grange2014" role="doc-biblioref">2014</a>)</span>, principal components of the patterns <span class="citation">(Bohland et al. <a href="references.html#ref-Bohland2010a" role="doc-biblioref">2010</a>)</span>, or patterns of coexpression modules were compared to traditional anatomy <span class="citation">(Grange et al. <a href="references.html#ref-Grange2014" role="doc-biblioref">2014</a>)</span>. At least in the mouse brain, with the principal components, these clusters may correspond to traditional anatomy quite well <span class="citation">(Bohland et al. <a href="references.html#ref-Bohland2010a" role="doc-biblioref">2010</a>)</span>. However, when cell types are taken into account in clustering, gene expression seems to be able to refine traditional anatomy <span class="citation">(Ko et al. <a href="references.html#ref-Ko2013" role="doc-biblioref">2013</a>; Grange et al. <a href="references.html#ref-Grange2014" role="doc-biblioref">2014</a>)</span>.</p>
<p>A clustering strategy for identifying spatial regions that takes the spatial neighborhood into account is <a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-867-machine-learning-fall-2006/lecture-notes/lec23.pdf">Markov random field (MRF)</a>. In MRFs, nearby voxels can be made to be more likely to share a label, which can be cell type or histological region, and the probability of a voxel taking each of the labels only depends on labels of neighboring voxels. MRFs were used to delineate spatial regions in a 3D FISH atlas of the developing <a href="https://platynereis.github.io/"><em>Platynereis dumereilii</em></a> brain <span class="citation">(Pettit et al. <a href="references.html#ref-Pettit2014" role="doc-biblioref">2014</a>)</span>, with 86 high quality genes. The images in the atlas were aligned into a 3D model and broken into voxels 3 <span class="math inline">\(\mu\)</span>m per side, which is smaller than a typical single cell; the spatial neighborhood graph is the 3D square grid of the voxels. As FISH is not very quantitative, the gene expression was manually binarized. Expression of each gene at each voxel is modeled with a <a href="https://mathworld.wolfram.com/BernoulliDistribution.html">Bernoulli distribution</a>, and the 86 genes are assumed to be independent. Cluster label assignment is modeled with <a href="https://en.wikipedia.org/wiki/Potts_model">Potts model</a>, a type of MRF in which only neighboring voxels with the same label contribute to the probability distribution of the labels, thus favoring neighbors with the same label. The parameters, such as interaction strength between neighboring voxels for the Potts model and the probability parameter of the Bernoulli distributions are estimated with <a href="http://ai.stanford.edu/~chuongdo/papers/em_tutorial.pdf">expectation maximization (EM)</a>.</p>
</div>
<div id="prequel-gene-interactions" class="section level2">
<h2>
<span class="header-section-number">3.3</span> Gene interactions<a class="anchor" aria-label="anchor" href="#prequel-gene-interactions"><i class="fas fa-link"></i></a>
</h2>
<p>While not single cell resolution, (WM)ISH atlases provide transcriptomes within the tissue at a resolution far higher than that of typical bulk RNA-seq and bulk microarray, thus opening the way to studying coexperssion and interaction between genes within the tissue. There are a few methods that aim to decide whether two genes interact according to (WM)ISH images, some dating published long before the popularization of scRNA-seq. Already in 2002, an early method that compares binarized gene expression patterns was used to identify interactions among genes by comparing patterns from wild type and mutant backgrounds <span class="citation">(Kumar et al. <a href="references.html#ref-Kumar2002" role="doc-biblioref">2002</a>)</span>.</p>
<p>However, as mutant lines are harder to obtain than wild type images, the simplest method is to set a threshold in <a href="https://www.questionpro.com/blog/pearson-correlation-coefficient/">Pearson correlation</a> coefficient between two genes to decide an edge should be drawn on the gene coexpression graph <span class="citation">(Wu et al. <a href="references.html#ref-Wu2016" role="doc-biblioref">2016</a>; Campiteli et al. <a href="references.html#ref-Campiteli2013" role="doc-biblioref">2013</a>)</span>.</p>
<p>Alternatively, a sparse <a href="http://ml.informatik.uni-freiburg.de/former/_media/teaching/ws1314/gm/11-markov_logic_networks.handout.pdf">Markov network</a> whose nodes are genes and edges are presence of interaction can be learnt from expression profiles in each voxel <span class="citation">(Puniyani and Xing <a href="references.html#ref-Puniyani2013" role="doc-biblioref">2013</a>)</span>, or a CNN can be trained on known interactions and predict new interactions based on gene expression patterns <span class="citation">(Yang, Fang, and Shen <a href="references.html#ref-Yang2019" role="doc-biblioref">2019</a>)</span>. There are other types of analyses, such as inferring gene function from expression pattern, identifying spatially variable genes, and gene expression imputation at locations. The latter two are still important topics in current era data analysis.</p>
</div>
<div id="decline" class="section level2">
<h2>
<span class="header-section-number">3.4</span> Decline<a class="anchor" aria-label="anchor" href="#decline"><i class="fas fa-link"></i></a>
</h2>
<p>What contributed to the decline of the golden age of prequel data analysis? Partly a lack of usage of the methods developed, which was exacerbated by the decline of the golden age of (WM)ISH atlases in the 2010s so there were fewer new atlases where the methods can be applied (Figure <a href="prequel.html#fig:hist1">2.3</a>). While many methods to automate gene expression pattern annotation for BDGP were developed before 2013, for the 2013 BDGP update that added images of 708 transcription factors, the BDGP annotated the new images with human curators instead of the automated methods <span class="citation">(Hammonds et al. <a href="references.html#ref-Hammonds2013" role="doc-biblioref">2013</a>)</span>. Nor did BDGP use the new methods to compare and classify the new gene expression patterns; instead, the curator assigned CV annotations were used for analysis <span class="citation">(Hammonds et al. <a href="references.html#ref-Hammonds2013" role="doc-biblioref">2013</a>; Tomancak et al. <a href="references.html#ref-Tomancak2007" role="doc-biblioref">2007</a>)</span>. BDGP did not have a major update after 2013; as existing images have already been annotated, there is no need to automate annotations.</p>
<p>There are additional possible reasons why these methods were not used: First, it is unclear from the publications of the methods where the software implementation can be obtained. Second, a reason why most prequel analysis methods were developed for either BDGP or ABA is that since one gene is stained for in one embryo/section at a time, the images must be registered and standardized for different genes to be comparable; BDGP, through FlyExpress <span class="citation">(Kumar et al. <a href="references.html#ref-Kumar2017" role="doc-biblioref">2017</a>)</span>, and ABA, provide images that have already been registered and standardized, while many other atlases, such as GEISHA, do not. Due to challenges in image registration in other organisms, the automated gene expression pattern analysis methods can’t be applied. Third, lack of usage of these methods can also be due to insufficient accuracy; from 2009 to 2013, the <a href="https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5">area under the curve (AUC)</a> of the automated annotations is typically around 0.8 and rarely exceeded 0.9 <span class="citation">(S. Ji, Li, et al. <a href="references.html#ref-Ji2009" role="doc-biblioref">2009</a>; Pruteanu-Malinici, Mace, and Ohler <a href="references.html#ref-Pruteanu-Malinici2011" role="doc-biblioref">2011</a>; Yuan et al. <a href="references.html#ref-Yuan2012" role="doc-biblioref">2012</a>; Sun et al. <a href="references.html#ref-Sun2013" role="doc-biblioref">2013</a>)</span>, which means when using such tools to annotate new images, extensive human review would still be required.</p>
</div>
<div id="geo-prequel-analysis" class="section level2">
<h2>
<span class="header-section-number">3.5</span> Geography of prequel data analysis<a class="anchor" aria-label="anchor" href="#geo-prequel-analysis"><i class="fas fa-link"></i></a>
</h2>
<p>If our collection is representative, then contribution to prequel data analysis concentrates in a few institutions (Figure <a href="prequel-analysis.html#fig:pa-map">3.4</a>), not all of which are elite.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pa-map"></span>
<img src="03-prequel_analysis_files/figure-html/pa-map-1.png" alt="Number of publications per city for prequel data analysis." width="100%"><p class="caption">
Figure 3.4: Number of publications per city for prequel data analysis.
</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pa-map-us"></span>
<img src="03-prequel_analysis_files/figure-html/pa-map-us-1.png" alt="Number of publications per city for prequel data analysis in the US." width="100%"><p class="caption">
Figure 3.5: Number of publications per city for prequel data analysis in the US.
</p>
</div>
<p>When broken down by species, it seems that distinct institutions contributed to data analysis of <em>Drosophila</em> and mouse data. UC Berkeley and Lawrence Berkeley National Laboratory (LBL) are responsible for BDGP, and Allen is responsible for ABA. However, among the top contributors are other institutions such as Arizona State University (ASU) and Old Dominion University (ODU) (Figure <a href="prequel-analysis.html#fig:pa-species2">3.6</a>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pa-species2"></span>
<img src="03-prequel_analysis_files/figure-html/pa-species2-1.png" alt="Number of publications per city for prequel data analysis broken down by species of interest." width="100%"><p class="caption">
Figure 3.6: Number of publications per city for prequel data analysis broken down by species of interest.
</p>
</div>

</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="prequel.html"><span class="header-section-number">2</span> Prequel era</a></div>
<div class="next"><a href="current.html"><span class="header-section-number">4</span> From the past to the present</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#prequel-analysis"><span class="header-section-number">3</span> Data analysis in the prequel era</a></li>
<li><a class="nav-link" href="#prequel-gene-patterns"><span class="header-section-number">3.1</span> Gene patterns</a></li>
<li><a class="nav-link" href="#prequel-spatial-regions"><span class="header-section-number">3.2</span> Spatial regions</a></li>
<li><a class="nav-link" href="#prequel-gene-interactions"><span class="header-section-number">3.3</span> Gene interactions</a></li>
<li><a class="nav-link" href="#decline"><span class="header-section-number">3.4</span> Decline</a></li>
<li><a class="nav-link" href="#geo-prequel-analysis"><span class="header-section-number">3.5</span> Geography of prequel data analysis</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/pachterlab/LP_2021/tree/main/supplement/blob/master/03-prequel_analysis.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/pachterlab/LP_2021/tree/main/supplement/edit/master/03-prequel_analysis.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Museum of Spatial Transcriptomics</strong>" was written by Lambda Moses, Lior Pachter. It was last built on 2022-02-03.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
